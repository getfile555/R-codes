# Program: To find the z-test

z_test <- function(x, mu, sigma, alternative = "two.sided") {
  # x: sample data
  # mu: hypothesized population mean
  # sigma: population standard deviation (known)
  # alternative: type of test ("two.sided", "less", "greater")

  # Sample size
  n <- length(x)

  # Z statistic
  z_stat <- (mean(x) - mu) / (sigma / sqrt(n))

  # P-value calculation
  if (alternative == "two.sided") {
    P_value <- 2 * (1 - pnorm(abs(z_stat)))
  } else if (alternative == "less") {
    P_value <- pnorm(z_stat)
  } else if (alternative == "greater") {
    P_value <- 1 - pnorm(z_stat)
  } else {
    stop("invalid alternative hypothesis. use 'two.sided', 'less', or 'greater.'")
  }

  # Result
  result <- list(
    Z_statistic = z_stat,
    P_value = P_value
  )

  # Conclusion
  if (P_value < 0.05) {
    cat("\nConclusion: Reject the null hypothesis (H0).\n")
  } else {
    cat("\nConclusion: Fail to reject the null hypothesis (H0).\n")
  }

  return(result)
}

# Example usage of the z-test function
# Hypothesis: Test if the mean weight is 70 (mu=70).
# Known population standard deviation: 10 (sigma=10).

# Sample data
sample_data <- c(72, 69, 74, 70, 71, 69, 63, 67, 75, 70)

# Perform Z-test
result <- z_test(
  x = sample_data,
  mu = 70,
  sigma = 10,
  alternative = "two.sided"
)

# Print results
print(result)
