# Aim: To find the Z-test
z_test <- function(x, mu, sigma, alternative = "two.sided") {

  # sample size
  n <- length(x)

  # z statistic
  z_stat <- (mean(x) - mu) / (sigma / sqrt(n))

  # P value calculation
  if (alternative == "two.sided") {
    # Two-sided test: P-value = 2 * P(Z > |z_stat|)
    P_value <- 2 * (1 - pnorm(abs(z_stat)))
  } else if (alternative == "less") {
    # Left-tailed test: P-value = P(Z < z_stat)
    P_value <- pnorm(z_stat)
  } else if (alternative == "greater") {
    # Right-tailed test: P-value = P(Z > z_stat)
    P_value <- 1 - pnorm(z_stat)
  } else {
    stop("Invalid alternative hypothesis. use 'two.sided', 'less', or 'greater.'")
  }

  list(
    Z_statistic = z_stat,
    P_value = P_value
  )
}

